<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PRC-Aligned SWLE Exam Builder (All Subjects)</title>
  <style>
    :root{
      --bg:#0f172a;--card:#111827;--muted:#1f2937;--text:#e5e7eb;--accent:#22d3ee;--good:#22c55e;--bad:#ef4444;--warn:#f59e0b;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;background:var(--bg);color:var(--text)}
    .wrap{max-width:1100px;margin:40px auto;padding:0 16px}
    .row{display:flex;gap:16px;flex-wrap:wrap}
    .card{background:linear-gradient(180deg,#111827, #0b1220);border:1px solid #1f2937;border-radius:18px;padding:16px;box-shadow:0 10px 25px rgba(0,0,0,.25)}
    .card h2,.card h3{margin:0 0 12px}
    .pill{display:inline-block;padding:4px 10px;border-radius:999px;background:#0b1220;border:1px solid #243141;color:#9fb0c5;font-size:12px}
    button,select,input[type="file"]{background:#0b1220;color:var(--text);border:1px solid #233045;border-radius:12px;padding:10px 14px;cursor:pointer}
    button:hover{border-color:#3b82f6}
    .primary{background:linear-gradient(180deg,#0ea5e9,#22d3ee);color:#001018;border:none}
    .primary:hover{filter:brightness(1.05)}
    .danger{background:#1a0b0b;color:#ffd8d8;border-color:#7f1d1d}
    .success{background:#0b1a14;color:#d1fae5;border-color:#064e3b}
    .warn{background:#1a140b;color:#ffedd5;border-color:#7c2d12}
    .grid{display:grid;gap:16px}
    .grid.g2{grid-template-columns:repeat(2,minmax(0,1fr))}
    .grid.g3{grid-template-columns:repeat(3,minmax(0,1fr))}
    .grid.g4{grid-template-columns:repeat(4,minmax(0,1fr))}
    @media(max-width:900px){.grid.g3,.grid.g4{grid-template-columns:1fr}.row{flex-direction:column}}
    table{width:100%;border-collapse:collapse}
    th,td{padding:8px;border-bottom:1px solid #233045;vertical-align:top}
    th{font-weight:600;text-align:left;color:#cfe3ff}
    .muted{opacity:.85}
    .flex{display:flex;gap:12px;align-items:center}
    .right{margin-left:auto}
    .badge{padding:2px 8px;border-radius:999px;border:1px solid #243141;background:#0b1220;font-size:12px}
    .ok{color:var(--good)}.no{color:var(--bad)}
    .q{padding:16px;border:1px solid #223046;border-radius:14px;margin:8px 0;background:#0b1220}
    .choice{padding:10px;border:1px solid #263246;border-radius:12px;margin:8px 0;cursor:pointer}
    .choice.correct{border-color:#14532d;background:#062014}
    .choice.wrong{border-color:#7f1d1d;background:#1a0b0b}
    .hide{display:none}
    .rationale{border-left:3px solid #233045;margin-top:6px;padding-left:10px;color:#bcd}
    .progress{height:10px;background:#0b1220;border:1px solid #233045;border-radius:999px;overflow:hidden}
    .bar{height:100%;background:linear-gradient(90deg,#22d3ee,#3b82f6)}
    .small{font-size:12px}
    .input{width:100%;background:#0b1220;border:1px solid #233045;border-radius:10px;padding:10px;color:var(--text)}
    .help{font-size:12px;color:#9fb0c5}
    .pillbar{display:flex;gap:8px;flex-wrap:wrap}
    .code{font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size:12px; background:#0b1220; border:1px solid #233045; padding:8px; border-radius:8px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="row">
      <div class="card" style="flex:1 1 460px">
        <h2>PRC-Aligned SWLE Exam Builder</h2>
        <div class="pillbar">
          <span class="pill">Subjects: HBSE, SWPPS, Practice I, Practice II, Practice III</span>
          <span class="pill">Difficulty split: 30% E • 40% M • 30% D</span>
          <span class="pill">Local Data Bank via <b>localStorage</b></span>
        </div>
        <p class="muted">Build 100-item exams per subject aligned to the PRC Table of Specifications. Add your own items, import/export JSON, and assemble exams with one click.</p>
        <div class="grid g3">
          <div class="card">
            <h3>Build Exam</h3>
            <label>Subject
              <select id="subjectSelect" class="input">
                <option>HBSE</option>
                <option>SWPPS</option>
                <option>Practice I</option>
                <option>Practice II</option>
                <option>Practice III</option>
              </select>
            </label>
            <label>Target items <input id="targetCount" class="input" type="number" value="100" min="10" max="200"/></label>
            <div class="flex" style="margin-top:10px">
              <button class="primary" id="btnBuild">Build Exam</button>
              <button id="btnShuffle">Shuffle Questions</button>
            </div>
            <div id="buildMsg" class="help" style="margin-top:8px"></div>
          </div>
          <div class="card">
            <h3>Bank: Import / Export</h3>
            <div class="flex">
              <input type="file" id="importFile" accept="application/json"/>
              <button id="btnImport">Import</button>
              <button id="btnExport">Export</button>
            </div>
          </div>
          <div class="card">
            <h3>Add Question</h3>
            <button id="openAdd" class="success">New Item</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Exam Panel -->
    <div class="card" id="examPanel" style="margin-top:16px" hidden>
      <div class="flex">
        <h3 style="margin:0">Exam Mode</h3>
        <div class="right pillbar">
          <span class="pill" id="metaCount">0/0</span>
          <span class="pill" id="metaScore">Score: 0</span>
          <label class="pill small"><input type="checkbox" id="showRationale" style="margin-right:6px">Show rationales</label>
        </div>
      </div>
      <div class="progress" style="margin:12px 0 6px"><div class="bar" id="bar" style="width:0%"></div></div>
      <div id="examList"></div>
      <div class="flex" style="margin-top:12px">
        <button id="btnAnswerKey">Show Answer Key</button>
        <button id="btnResetExam" class="danger">Reset Exam</button>
      </div>
      <div id="answerKey" class="q hide"></div>
    </div>
  </div>

  <script>
    /***** SUBJECT ALLOCATION MATRICES *****/
    const ALLOCATIONS = {
      HBSE: {
        difficultySplit:{Easy:0.30, Moderate:0.40, Difficult:0.30},
        topics:[
          { key:"A1", topic:"Philippine Social Realities & Social Work Concepts/Tools", count:17 },
          { key:"A2", topic:"Anatomy of Social Problems & Theories", count:3 },
          { key:"B", topic:"Filipino Personality & Social Work", count:20 },
          { key:"C", topic:"Social Work & Social Deviation", count:20 },
          { key:"D", topic:"Social Environment: Family/Group/Community/Org", count:20 },
          { key:"E", topic:"Social Change & Development Perspectives", count:20 },
        ]
      },
      SWPPS: {
        difficultySplit:{Easy:0.30, Moderate:0.40, Difficult:0.30},
        topics:[ /* Fill from PRC TOS */ ]
      },
      "Practice I": {
        difficultySplit:{Easy:0.30, Moderate:0.40, Difficult:0.30},
        topics:[ /* Fill from PRC TOS */ ]
      },
      "Practice II": {
        difficultySplit:{Easy:0.30, Moderate:0.40, Difficult:0.30},
        topics:[ /* Fill from PRC TOS */ ]
      },
      "Practice III": {
        difficultySplit:{Easy:0.30, Moderate:0.40, Difficult:0.30},
        topics:[ /* Fill from PRC TOS */ ]
      }
    };

    // --- Other scripts (bank handling, exam building, etc.) will be adapted to use subjectSelect ---
  </script>
</body>
</html>
